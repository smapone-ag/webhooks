(function(e){function t(t){for(var s,c,i=t[0],l=t[1],r=t[2],b=0,h=[];b<i.length;b++)c=i[b],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&h.push(a[c][0]),a[c]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);p&&p(t);while(h.length)h.shift()();return n.push.apply(n,r||[]),o()}function o(){for(var e,t=0;t<n.length;t++){for(var o=n[t],s=!0,i=1;i<o.length;i++){var l=o[i];0!==a[l]&&(s=!1)}s&&(n.splice(t--,1),e=c(c.s=o[0]))}return e}var s={},a={app:0},n=[];function c(t){if(s[t])return s[t].exports;var o=s[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,c),o.l=!0,o.exports}c.m=e,c.c=s,c.d=function(e,t,o){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(c.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)c.d(o,s,function(t){return e[t]}.bind(null,s));return o},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/webhooks/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var r=0;r<i.length;r++)t(i[r]);var p=l;n.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"0573":function(e,t,o){},"56d7":function(e,t,o){"use strict";o.r(t);var s=o("7a23");const a={class:"container"},n={key:0,class:"box token-input"},c=Object(s["f"])("br",null,null,-1),i=Object(s["f"])("div",{class:"token-info"},[Object(s["g"])(" Is it safe to enter token here? "),Object(s["f"])("ul",null,[Object(s["f"])("li",null,"This script runs on github (which only allows frontend, no backend services), you can track all calls done by the frontend in your browser console."),Object(s["f"])("li",null,[Object(s["g"])("If you don't trust this application, feel free to "),Object(s["f"])("a",{href:"https://github.com/moritzhesse/webhooks"},"download the script"),Object(s["g"])(" and to compile and run by yourself.")])])],-1);function l(e,t,o,l,r,p){const b=Object(s["m"])("smap-list");return Object(s["i"])(),Object(s["e"])("div",a,[null===r.token?(Object(s["i"])(),Object(s["e"])("div",n,[Object(s["g"])(" Enter your smapOne API token here"),c,Object(s["p"])(Object(s["f"])("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>r.token=e),placeholder:"smapOne API token"},null,512),[[s["o"],r.token]]),i])):Object(s["d"])("",!0),r.api?(Object(s["i"])(),Object(s["c"])(b,{key:1,api:r.api},null,8,["api"])):Object(s["d"])("",!0)])}o("5494");const r=e=>(Object(s["k"])("data-v-41e26252"),e=e(),Object(s["j"])(),e),p={id:"settings",class:"box"},b=r(()=>Object(s["f"])("code",{class:"method method-post"},"post",-1)),h=[b],m=r(()=>Object(s["f"])("code",{class:"method method-get"},"get",-1)),u=[m],d={class:"box"};function O(e,t,o,a,n,c){const i=Object(s["m"])("smap-item");return Object(s["i"])(),Object(s["e"])(s["a"],null,[Object(s["f"])("div",p,[Object(s["p"])(Object(s["f"])("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>n.filter.name=e),placeholder:"Search smap name"},null,512),[[s["o"],n.filter.name]]),Object(s["f"])("span",{class:Object(s["h"])(["filter",{active:!1===n.filter.group}]),onClick:t[1]||(t[1]=e=>c.setFilterGroup(!1))},"all",2),Object(s["f"])("span",{class:Object(s["h"])(["filter",{active:"webhook"==n.filter.group}]),onClick:t[2]||(t[2]=e=>c.setFilterGroup("webhook"))},"with webhook",2),Object(s["f"])("span",{class:Object(s["h"])(["filter",{active:"post"==n.filter.group}]),onClick:t[3]||(t[3]=e=>c.setFilterGroup("post"))},h,2),Object(s["f"])("span",{class:Object(s["h"])(["filter",{active:"get"==n.filter.group}]),onClick:t[4]||(t[4]=e=>c.setFilterGroup("get"))},u,2),Object(s["f"])("span",{class:Object(s["h"])(["filter",{active:"no-webhook"==n.filter.group}]),onClick:t[5]||(t[5]=e=>c.setFilterGroup("no-webhook"))},"no webhook",2)]),Object(s["f"])("div",d,[(Object(s["i"])(!0),Object(s["e"])(s["a"],null,Object(s["l"])(c.filteredSmaps,e=>(Object(s["i"])(),Object(s["c"])(i,{key:e.smapId,smap:e,api:o.api,class:"smap",onDisplayWebhook:c.onDisplayWebhook},null,8,["smap","api","onDisplayWebhook"]))),128))])],64)}const f=e=>(Object(s["k"])("data-v-31b84a84"),e=e(),Object(s["j"])(),e),j={key:0,class:"info-no-webhook"},k={key:0,class:"info-fetching"},w={key:1,class:"smap-meta"},v={class:"smap-meta-box"},y={class:"smap-meta-box"},g={key:0},S={class:"smap-meta-box smap-meta-cols"},x={class:"smap-meta-box"},W={class:"smap-meta-box"},I={class:"smap-meta-box"},P={key:0,class:"smap-meta-box"},U=f(()=>Object(s["f"])("div",null,"Webhook URL",-1)),C=["value"],D={class:"smap-meta-box smap-meta-cols"},L={key:2},$={key:0},T={key:0,class:"method method-get"},_={key:1,class:"method method-post"},G={class:"webhook-url"};function M(e,t,o,a,n,c){return o.smap?(Object(s["i"])(),Object(s["e"])("div",{key:0,class:Object(s["h"])(["smap",{webhook:o.smap.webhook,fetching:null===o.smap.webhook,"no-webhook":!1===o.smap.webhook}])},[Object(s["f"])("div",{class:"smap-name",onClick:t[0]||(t[0]=e=>n.showMeta=!n.showMeta)},[Object(s["g"])(Object(s["n"])(o.smap.name)+" ",1),!1===o.smap.webhook?(Object(s["i"])(),Object(s["e"])("span",j,"no webhook")):Object(s["d"])("",!0)]),null===o.smap.webhook?(Object(s["i"])(),Object(s["e"])("div",k,"fetching...")):Object(s["d"])("",!0),n.showMeta?(Object(s["i"])(),Object(s["e"])("div",w,[Object(s["f"])("div",v,[Object(s["g"])(" smapID "),Object(s["f"])("code",null,Object(s["n"])(o.smap.smapId),1)]),Object(s["f"])("div",y,[Object(s["f"])("div",null,[Object(s["g"])(" Last changed "),Object(s["f"])("code",null,Object(s["n"])(c.getDate(o.smap.lastChanged)),1)]),o.smap.lastPublishedVersion?(Object(s["i"])(),Object(s["e"])("div",g,[Object(s["g"])(" Version "),Object(s["f"])("code",null,Object(s["n"])(o.smap.lastPublishedVersion.version),1)])):Object(s["d"])("",!0)]),Object(s["f"])("div",S,[Object(s["f"])("div",x,[Object(s["g"])(" Licenses "),Object(s["f"])("code",null,Object(s["n"])(o.smap.userLicenseCount),1)]),Object(s["f"])("div",W,[Object(s["g"])(" Installations "),Object(s["f"])("code",null,Object(s["n"])(o.smap.installationsCount),1)]),Object(s["f"])("div",I,[Object(s["g"])(" Data entries "),Object(s["f"])("code",null,Object(s["n"])(o.smap.totalDataCount),1)])]),o.smap.webhook?(Object(s["i"])(),Object(s["e"])("div",P,[U,Object(s["f"])("div",null,[Object(s["f"])("input",{type:"text",value:o.smap.webhook.serverUrl},null,8,C)])])):Object(s["d"])("",!0),Object(s["f"])("div",D,[Object(s["f"])("div",{class:"set-webhook smap-meta-box",onClick:t[1]||(t[1]=e=>c.setWebhook())}," Set new webhook "),o.smap.webhook?(Object(s["i"])(),Object(s["e"])("div",{key:0,class:"remove-webhook smap-meta-box",onClick:t[2]||(t[2]=e=>c.removeWebhook())}," Remove webhook ")):Object(s["d"])("",!0)])])):Object(s["d"])("",!0),o.smap.webhook?(Object(s["i"])(),Object(s["e"])("div",L,[o.smap.webhook.options?(Object(s["i"])(),Object(s["e"])("div",$,[Object(s["f"])("div",null,["HttpGet"===o.smap.webhook.options?(Object(s["i"])(),Object(s["e"])("code",T,"get")):Object(s["d"])("",!0),"HttpPost"===o.smap.webhook.options?(Object(s["i"])(),Object(s["e"])("code",_,"post")):Object(s["d"])("",!0),Object(s["f"])("span",G,Object(s["n"])(c.getReadableUrl(o.smap.webhook.serverUrl)),1)])])):Object(s["d"])("",!0)])):Object(s["d"])("",!0)],2)):Object(s["d"])("",!0)}var R={name:"SmapItem",emits:["displayWebhook"],data(){return{showMeta:!1}},props:{api:Object,smap:Object},async created(){let e=await this.api.getWebhook(this.smap.smapId);null===e?this.$emit("displayWebhook",this.smap.smapId,!1):this.$emit("displayWebhook",this.smap.smapId,e)},methods:{getReadableUrl(e){let t=e;if(e.length>48){const o=e.substr(0,32),s=e.substr(e.length-16,e.length);t=`${o}...${s}`}return t},getDate(e){const t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString("en-US",t)},async setWebhook(){const e="HttpPost",t=prompt("Target URL (must be https)");if(!1!==this.isValidHttpUrl(t)&&null!=t){const o=await this.api.setWebhook(this.smap.smapId,t,e);204==o.status&&this.$emit("displayWebhook",this.smap.smapId,{serverUrl:t,options:e})}else alert("Sorry, this is no valid URL. Please try again.")},async removeWebhook(){if(1==confirm("Sure?")){const e=await this.api.removeWebhook(this.smap.smapId);204==e.status&&this.$emit("displayWebhook",this.smap.smapId,!1)}},isValidHttpUrl(e){let t;try{t=new URL(e)}catch(o){return!1}return"https:"===t.protocol}}},H=(o("5b2a"),o("6b0d")),V=o.n(H);const F=V()(R,[["render",M],["__scopeId","data-v-31b84a84"]]);var B=F,E={name:"SmapList",components:{SmapItem:B},data(){return{filter:{name:null,group:!1},smaps:[]}},props:{api:Object},async created(){let e=await this.api.getSmaps();null!==e&&(this.smaps=e.sort((e,t)=>e.name.localeCompare(t.name)))},computed:{filteredSmaps(){const e=this.filter;return this.smaps.filter((function(t){let o=!1;e.group?("webhook"==e.group&&!1!==t.webhook&&null!==t.webhook||"no-webhook"==e.group&&!1===t.webhook||"get"==e.group&&t.webhook&&"HttpGet"==t.webhook.options||"post"==e.group&&t.webhook&&"HttpPost"==t.webhook.options)&&(o=!0):o=!0;let s=!1;return(null===e.name||t.name.toLowerCase().includes(e.name.toLowerCase()))&&(s=!0),o&&s}))}},methods:{setFilterGroup:function(e){this.filter.group=e},onDisplayWebhook:function(e,t){let o=this.smaps.find(t=>t.smapId==e);"undefined"!==typeof o&&(o.webhook=t)}}};o("ae82");const N=V()(E,[["render",O],["__scopeId","data-v-41e26252"]]);var A=N,J=o("cc9a"),z=o.n(J),q={name:"App",components:{SmapList:A},data(){return{token:null,api:null}},async created(){const e=window.location.search,t=new URLSearchParams(e);t.has("token")&&(this.token=t.get("token"))},watch:{token(e,t){this.api=new z.a(this.token)}}};o("9dcd");const K=V()(q,[["render",l]]);var Q=K;Object(s["b"])(Q).mount("#app")},"5b2a":function(e,t,o){"use strict";o("836e")},"836e":function(e,t,o){},"9dcd":function(e,t,o){"use strict";o("d3e3")},ae82:function(e,t,o){"use strict";o("0573")},cc9a:function(e,t){class o{constructor(e){this.token=e}async getSmaps(){let e="https://platform.smapone.com/Backend/v1/Smaps";return await this.get(e)}async getWebhook(e){let t=`https://platform.smapone.com/Backend/intern/Smaps/${e}/Notification/Data/Webhook`;return await this.get(t)}async get(e){e=`${e}?accessToken=${this.token}`;let t=await fetch(e);return await t.json()}async setWebhook(e,t,o){let s=`https://platform.smapone.com/Backend/intern/Smaps/${e}/Notification/Data/Webhook?accessToken=${this.token}`,a={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({ServerUrl:t,Options:o})};try{let e=await fetch(s,a);return e}catch(n){console.log({error:n})}}async removeWebhook(e){let t=`https://platform.smapone.com/Backend/intern/Smaps/${e}/Notification/Data/Webhook?accessToken=${this.token}`,o={method:"DELETE"};try{let e=await fetch(t,o);return e}catch(s){console.log({error:s})}}}e.exports=o},d3e3:function(e,t,o){}});
//# sourceMappingURL=app.374954c1.js.map